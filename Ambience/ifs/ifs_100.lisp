(defun if-test (mode)
  (cond 
    ((eq mode 0) 0) 
    ((eq mode 1) 1) 
    ((eq mode 2) 2) 
    ((eq mode 3) 3) 
    ((eq mode 4) 4) 
    ((eq mode 5) 5) 
    ((eq mode 6) 6) 
    ((eq mode 7) 7) 
    ((eq mode 8) 8) 
    ((eq mode 9) 9) 
    ((eq mode 10) 10) 
    ((eq mode 11) 11) 
    ((eq mode 12) 12) 
    ((eq mode 13) 13) 
    ((eq mode 14) 14) 
    ((eq mode 15) 15) 
    ((eq mode 16) 16) 
    ((eq mode 17) 17) 
    ((eq mode 18) 18) 
    ((eq mode 19) 19) 
    ((eq mode 20) 20) 
    ((eq mode 21) 21) 
    ((eq mode 22) 22) 
    ((eq mode 23) 23) 
    ((eq mode 24) 24) 
    ((eq mode 25) 25) 
    ((eq mode 26) 26) 
    ((eq mode 27) 27) 
    ((eq mode 28) 28) 
    ((eq mode 29) 29) 
    ((eq mode 30) 30) 
    ((eq mode 31) 31) 
    ((eq mode 32) 32) 
    ((eq mode 33) 33) 
    ((eq mode 34) 34) 
    ((eq mode 35) 35) 
    ((eq mode 36) 36) 
    ((eq mode 37) 37) 
    ((eq mode 38) 38) 
    ((eq mode 39) 39) 
    ((eq mode 40) 40) 
    ((eq mode 41) 41) 
    ((eq mode 42) 42) 
    ((eq mode 43) 43) 
    ((eq mode 44) 44) 
    ((eq mode 45) 45) 
    ((eq mode 46) 46) 
    ((eq mode 47) 47) 
    ((eq mode 48) 48) 
    ((eq mode 49) 49) 
    ((eq mode 50) 50) 
    ((eq mode 51) 51) 
    ((eq mode 52) 52) 
    ((eq mode 53) 53) 
    ((eq mode 54) 54) 
    ((eq mode 55) 55) 
    ((eq mode 56) 56) 
    ((eq mode 57) 57) 
    ((eq mode 58) 58) 
    ((eq mode 59) 59) 
    ((eq mode 60) 60) 
    ((eq mode 61) 61) 
    ((eq mode 62) 62) 
    ((eq mode 63) 63) 
    ((eq mode 64) 64) 
    ((eq mode 65) 65) 
    ((eq mode 66) 66) 
    ((eq mode 67) 67) 
    ((eq mode 68) 68) 
    ((eq mode 69) 69) 
    ((eq mode 70) 70) 
    ((eq mode 71) 71) 
    ((eq mode 72) 72) 
    ((eq mode 73) 73) 
    ((eq mode 74) 74) 
    ((eq mode 75) 75) 
    ((eq mode 76) 76) 
    ((eq mode 77) 77) 
    ((eq mode 78) 78) 
    ((eq mode 79) 79) 
    ((eq mode 80) 80) 
    ((eq mode 81) 81) 
    ((eq mode 82) 82) 
    ((eq mode 83) 83) 
    ((eq mode 84) 84) 
    ((eq mode 85) 85) 
    ((eq mode 86) 86) 
    ((eq mode 87) 87) 
    ((eq mode 88) 88) 
    ((eq mode 89) 89) 
    ((eq mode 90) 90) 
    ((eq mode 91) 91) 
    ((eq mode 92) 92) 
    ((eq mode 93) 93) 
    ((eq mode 94) 94) 
    ((eq mode 95) 95) 
    ((eq mode 96) 96) 
    ((eq mode 97) 97) 
    ((eq mode 98) 98) 
    ((eq mode 99) 99) 
    ((eq mode 100) 100) 
)) 

(defvar beginning-time 0) 
(defvar num 0) 
 
(defun testContexts () 
    (let ((res 0)) 
    (setq beginning-time (get-internal-real-time))
    (loop for i from 0 to 1000
      do (setq num (+ (random 100) 1))
      (loop for j from 1 to 100
        do (if-test num)))
      (setq res (- (get-internal-real-time) beginning-time))
      res))

(defvar elapsed-time -1)
(defvar filename "")
 
(defun ifs-runs (run)
  (setq filename (format nil "runs_ifs/100/test~d.csv" run))
  (with-open-file (str filename
                    :direction :output
                    :if-exists :supersede
                    :if-does-not-exist :create)
    (format str "Iteration, Elapsed time in milliseconds ~%")
      (loop for times from 1 to 100
        do (setq elapsed-time (testContexts))
        (format str "~d, ~d~%" times elapsed-time))))

(defun main ()
  (loop for run from 1 to 10
    do (ifs-runs run)))
