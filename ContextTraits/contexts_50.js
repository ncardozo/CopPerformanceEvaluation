require("underscore");
var Trait = require("./traits.js").Trait;
var cop = require("./context-traits.js");

var foo;
Foo = function() {};
Foo.prototype.test = function() {
    throw new Error('Base method needs to be specialized');
}
foo = new Foo();

Context1 = new cop.Context();
Adaptation1 = Trait ({
    test: function() {
        return 1;
    }
});
Context1.adapt(foo, Adaptation1); 

Context2 = new cop.Context();
Adaptation2 = Trait ({
    test: function() {
        return 2;
    }
});
Context2.adapt(foo, Adaptation2); 

Context3 = new cop.Context();
Adaptation3 = Trait ({
    test: function() {
        return 3;
    }
});
Context3.adapt(foo, Adaptation3); 

Context4 = new cop.Context();
Adaptation4 = Trait ({
    test: function() {
        return 4;
    }
});
Context4.adapt(foo, Adaptation4); 

Context5 = new cop.Context();
Adaptation5 = Trait ({
    test: function() {
        return 5;
    }
});
Context5.adapt(foo, Adaptation5); 

Context6 = new cop.Context();
Adaptation6 = Trait ({
    test: function() {
        return 6;
    }
});
Context6.adapt(foo, Adaptation6); 

Context7 = new cop.Context();
Adaptation7 = Trait ({
    test: function() {
        return 7;
    }
});
Context7.adapt(foo, Adaptation7); 

Context8 = new cop.Context();
Adaptation8 = Trait ({
    test: function() {
        return 8;
    }
});
Context8.adapt(foo, Adaptation8); 

Context9 = new cop.Context();
Adaptation9 = Trait ({
    test: function() {
        return 9;
    }
});
Context9.adapt(foo, Adaptation9); 

Context10 = new cop.Context();
Adaptation10 = Trait ({
    test: function() {
        return 10;
    }
});
Context10.adapt(foo, Adaptation10); 

Context11 = new cop.Context();
Adaptation11 = Trait ({
    test: function() {
        return 11;
    }
});
Context11.adapt(foo, Adaptation11); 

Context12 = new cop.Context();
Adaptation12 = Trait ({
    test: function() {
        return 12;
    }
});
Context12.adapt(foo, Adaptation12); 

Context13 = new cop.Context();
Adaptation13 = Trait ({
    test: function() {
        return 13;
    }
});
Context13.adapt(foo, Adaptation13); 

Context14 = new cop.Context();
Adaptation14 = Trait ({
    test: function() {
        return 14;
    }
});
Context14.adapt(foo, Adaptation14); 

Context15 = new cop.Context();
Adaptation15 = Trait ({
    test: function() {
        return 15;
    }
});
Context15.adapt(foo, Adaptation15); 

Context16 = new cop.Context();
Adaptation16 = Trait ({
    test: function() {
        return 16;
    }
});
Context16.adapt(foo, Adaptation16); 

Context17 = new cop.Context();
Adaptation17 = Trait ({
    test: function() {
        return 17;
    }
});
Context17.adapt(foo, Adaptation17); 

Context18 = new cop.Context();
Adaptation18 = Trait ({
    test: function() {
        return 18;
    }
});
Context18.adapt(foo, Adaptation18); 

Context19 = new cop.Context();
Adaptation19 = Trait ({
    test: function() {
        return 19;
    }
});
Context19.adapt(foo, Adaptation19); 

Context20 = new cop.Context();
Adaptation20 = Trait ({
    test: function() {
        return 20;
    }
});
Context20.adapt(foo, Adaptation20); 

Context21 = new cop.Context();
Adaptation21 = Trait ({
    test: function() {
        return 21;
    }
});
Context21.adapt(foo, Adaptation21); 

Context22 = new cop.Context();
Adaptation22 = Trait ({
    test: function() {
        return 22;
    }
});
Context22.adapt(foo, Adaptation22); 

Context23 = new cop.Context();
Adaptation23 = Trait ({
    test: function() {
        return 23;
    }
});
Context23.adapt(foo, Adaptation23); 

Context24 = new cop.Context();
Adaptation24 = Trait ({
    test: function() {
        return 24;
    }
});
Context24.adapt(foo, Adaptation24); 

Context25 = new cop.Context();
Adaptation25 = Trait ({
    test: function() {
        return 25;
    }
});
Context25.adapt(foo, Adaptation25); 

Context26 = new cop.Context();
Adaptation26 = Trait ({
    test: function() {
        return 26;
    }
});
Context26.adapt(foo, Adaptation26); 

Context27 = new cop.Context();
Adaptation27 = Trait ({
    test: function() {
        return 27;
    }
});
Context27.adapt(foo, Adaptation27); 

Context28 = new cop.Context();
Adaptation28 = Trait ({
    test: function() {
        return 28;
    }
});
Context28.adapt(foo, Adaptation28); 

Context29 = new cop.Context();
Adaptation29 = Trait ({
    test: function() {
        return 29;
    }
});
Context29.adapt(foo, Adaptation29); 

Context30 = new cop.Context();
Adaptation30 = Trait ({
    test: function() {
        return 30;
    }
});
Context30.adapt(foo, Adaptation30); 

Context31 = new cop.Context();
Adaptation31 = Trait ({
    test: function() {
        return 31;
    }
});
Context31.adapt(foo, Adaptation31); 

Context32 = new cop.Context();
Adaptation32 = Trait ({
    test: function() {
        return 32;
    }
});
Context32.adapt(foo, Adaptation32); 

Context33 = new cop.Context();
Adaptation33 = Trait ({
    test: function() {
        return 33;
    }
});
Context33.adapt(foo, Adaptation33); 

Context34 = new cop.Context();
Adaptation34 = Trait ({
    test: function() {
        return 34;
    }
});
Context34.adapt(foo, Adaptation34); 

Context35 = new cop.Context();
Adaptation35 = Trait ({
    test: function() {
        return 35;
    }
});
Context35.adapt(foo, Adaptation35); 

Context36 = new cop.Context();
Adaptation36 = Trait ({
    test: function() {
        return 36;
    }
});
Context36.adapt(foo, Adaptation36); 

Context37 = new cop.Context();
Adaptation37 = Trait ({
    test: function() {
        return 37;
    }
});
Context37.adapt(foo, Adaptation37); 

Context38 = new cop.Context();
Adaptation38 = Trait ({
    test: function() {
        return 38;
    }
});
Context38.adapt(foo, Adaptation38); 

Context39 = new cop.Context();
Adaptation39 = Trait ({
    test: function() {
        return 39;
    }
});
Context39.adapt(foo, Adaptation39); 

Context40 = new cop.Context();
Adaptation40 = Trait ({
    test: function() {
        return 40;
    }
});
Context40.adapt(foo, Adaptation40); 

Context41 = new cop.Context();
Adaptation41 = Trait ({
    test: function() {
        return 41;
    }
});
Context41.adapt(foo, Adaptation41); 

Context42 = new cop.Context();
Adaptation42 = Trait ({
    test: function() {
        return 42;
    }
});
Context42.adapt(foo, Adaptation42); 

Context43 = new cop.Context();
Adaptation43 = Trait ({
    test: function() {
        return 43;
    }
});
Context43.adapt(foo, Adaptation43); 

Context44 = new cop.Context();
Adaptation44 = Trait ({
    test: function() {
        return 44;
    }
});
Context44.adapt(foo, Adaptation44); 

Context45 = new cop.Context();
Adaptation45 = Trait ({
    test: function() {
        return 45;
    }
});
Context45.adapt(foo, Adaptation45); 

Context46 = new cop.Context();
Adaptation46 = Trait ({
    test: function() {
        return 46;
    }
});
Context46.adapt(foo, Adaptation46); 

Context47 = new cop.Context();
Adaptation47 = Trait ({
    test: function() {
        return 47;
    }
});
Context47.adapt(foo, Adaptation47); 

Context48 = new cop.Context();
Adaptation48 = Trait ({
    test: function() {
        return 48;
    }
});
Context48.adapt(foo, Adaptation48); 

Context49 = new cop.Context();
Adaptation49 = Trait ({
    test: function() {
        return 49;
    }
});
Context49.adapt(foo, Adaptation49); 

Context50 = new cop.Context();
Adaptation50 = Trait ({
    test: function() {
        return 50;
    }
});
Context50.adapt(foo, Adaptation50); 


function testContexts() {
    var i;
    var j;
    var ITER = 1000;
    var CALLS = 100;
    var beginning_time = new Date().getTime();
    for(i = 0; i < ITER; i++) {
        num = 1 + Math.floor(Math.random()*50);
        eval("Context"+num+".activate();");
        for(j=1; j<=CALLS; j++) {
          foo.test();
        }
        eval("Context"+num+".deactivate();");
    }
    var end_time = new Date().getTime();
    return end_time - beginning_time;
} 

function runs(run) {
    var fs = require("fs");
    var times;
    fs.writeFileSync("./runs_contexts/50/test"+run+".csv", "");
    fs.appendFileSync("./runs_contexts/50/test"+run+".csv", "iteration, Elapsed time in milliseconds \n");
    for(times = 1; times <= 100; times++) {
        var elapsed_time = testContexts();
        fs.appendFileSync("./runs_contexts/50/test"+run+".csv", times + "," + elapsed_time + "\n");
    }
}

var run;
for(run=1; run <=10; run++) {
    runs(run);
}

